import re

# 제목 키워드 추출 (/ai/marketing)
def generate_title_and_keywords_from_markdown(markdown_text: str) -> dict:
    # 제목 추출: "# 제목"
    title_match = re.search(r"# (.+)", markdown_text)
    title = title_match.group(1).strip() if title_match else "관광 기획서"

    # 키워드 추출: "### 7. 추천 키워드" 아래의 "# 해시태그" 형식
    keyword_block = re.search(r"### 7. 추천 키워드\s*(.+)", markdown_text)
    if keyword_block:
        # 키워드 추출: `#`으로 시작하는 부분을 모두 찾기
        keywords = re.findall(r"#(\S+)", keyword_block.group(1))
        keywords = keywords[:3]  # 최대 3개 키워드
    else:
        keywords = []

    return {
        "title": title,
        "keyword": keywords
    }


# 테스트용 markdown 텍스트
markdown_text = """
## [관광상품 기획서] 제주 서귀포 유채꽃 산책

### 1. 기획 배경

- **계절성**: 봄 시즌 제주도 여행의 핵심 키워드는 '유채꽃'이다. 4월 말~5월 초는 유채꽃 개화 절정기로, SNS 상에서 제주 유채꽃 관련 콘텐츠 소비량이 급증하는 시기이다. 이 기간 동안 제주를 찾는 관광객은 자연스럽게 유채꽃 명 소를 방문하고자 하는 니즈가 높다.
- **지역성**: 서귀포시는 제주도 내에서도 유채꽃 명소로 유명하며, 특히 본 상품이 기획된 지역은 접근성이 뛰어나 면서도 인파가 덜 붐비는 숨겨진 명소로, 프라이빗한 경험 을 중시하는 최근 여행 트렌드에 부합한다.
- **경험 트렌드**: 단순 관광을 넘어 '경험'과 '인증샷'을 중시하는 MZ세대의 여행 트렌드를 반영하여, 유채꽃 절경 속에서의 산책과 더불어 제주 전통 간식 체험, 인생샷 스팟 제공 등의 요소를 결합하여 상품 경쟁력을 확보했다.     

### 2. 주요 타깃

- **2030 여성**: 감성적인 경험과 SNS 공유를 중시하는 2030 여성을 핵심 타깃으로 설정. 특히, 친구, 연인, 가족과 함께 제주를 찾아 인생샷을 남기고 싶어하는 여행객에게 어필할 것으로 예상된다.
- **만족 포인트**:
    * 봄 분위기를 만끽할 수 있는 유채꽃 절경 속 산책   
    * 제주 전통 간식을 통해 지역 문화 체험
    *  다양한 포토존에서 인생샷 촬영 및 SNS 공유를 통한 자기표현 실현
    *  혼잡한 관광지를 피해 프라이빗하고 여유로운 여행 경험 추구


### 3. 상품 개요

- **상세 설명**: 서귀포 숨겨진 유채꽃 명소를 따라 걷는 2시간 코스의 프라이빗 산책 프로그램 (전문 가이드 동행) 
- **장소**: 제주 서귀포시 (세부 위치는 예약 확정 후 공 개)
- **이용 가능 날짜**: 2025-04-20 ~ 2025-05-05
- **소요 시간**: 2시간 (이동 시간 포함)
- **가격**: 30,000원/1인
- **환불 정책**: 이용일 하루 전까지 100% 환불, 당일 취 소 불가


### 4. 상품 구성

1. **도착 및 안내**:  지정된 장소에 집결 후 가이드 미팅 및 간단한 안내 진행 (10분)
2. **유채꽃길 산책**: 숨겨진 유채꽃밭을 따라 여유롭게  산책하며 자연 경관 감상 및 사진 촬영 (60분) - 중간중간 촬영 명소에서 가이드가 사진 촬영 지원
3. **제주 전통 간식 체험**:  유채꽃밭 인근에서 제주 전 통 오메기떡과 감귤 주스를 즐기는 시간 (30분) -  피크닉 매트 제공 및 자유로운 사진 촬영 시간 포함
4. **포토존 촬영**: 유채꽃을 배경으로 인생샷을 남길 수 있는 전용 포토존에서 자유 촬영 (20분) - 소품(꽃, 화관  등) 무료 대여
5. **해산**: 지정된 장소에서 해산

- **포함 항목**: 가이드, 입장료, 간식(오메기떡, 감귤 주스), 사진 촬영 지원, 소품 대여
- **불포함 항목**: 개인 경비, 교통비


### 5. 마케팅 포인트

- **인생샷 보장**: 유채꽃 절경 속 다양한 포토존과 소품 제공을 통해 인생샷 촬영을 적극 지원하며, 이를 SNS 콘텐 츠로 활용하여 바이럴 마케팅 유도.
- **프라이빗 경험**: 숨겨진 명소를 발굴하여 혼잡한 관광지를 피해 여유로운 여행을 선호하는 타겟의 니즈를 충족. 
- **제주 감성 충전**: 유채꽃, 전통 간식 등 제주 특유의 감성을 담은 프로그램 구성으로 힐링 경험 제공.
- **가성비**: 합리적인 가격으로 다채로운 경험 제공 (유 사 상품 대비 경쟁력 있는 가격).


### 6. 차별화 요소

- **숨겨진 명소**:  대부분의 유채꽃 관광 상품은 혼잡한 관광 명소 위주로 구성된 반면, 본 상품은 숨겨진 유채꽃밭을 소개하여 프라이빗하고 여유로운 경험을 제공.
- **전문 가이드 동행**:  단순 관광을 넘어 제주 지역에  대한 전문적인 설명과 함께 최고의 사진 촬영을 지원하는  가이드 동행 서비스 제공.
- **맞춤형 포토존**: 일반적인 유채꽃밭과 달리 인생샷 촬영에 최적화된 전용 포토존 및 소품을 제공하여 차별화된  경험 제공.


### 7. 추천 키워드

`#제주유채꽃`, `#숨은명소`, `#인생샷`, `#프라이빗투어`, `#제주감성`


### 8. 참고 이미지

[유채꽃밭 전경](https://cdn.example.com/uploads/jeju1.jpg)

[포토존 예시](https://cdn.example.com/uploads/jeju2.jpg)
"""

result = generate_title_and_keywords_from_markdown(markdown_text)
print(result)
